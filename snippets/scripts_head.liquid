{% comment %} AOS Style {% endcomment %}
<link rel="stylesheet" href="{{ 'aos.css' | asset_url }}" media="print" onload="this.media='all'">

<!-- Initialize the theme queue system (loads immediately, no dependencies) -->
<script src="{{ 'theme-init-queue.js' | asset_url }}"></script>

<!-- Vendor Scripts: jQuery + plugins (MUST load before inline scripts) -->
<!-- This CANNOT be deferred because inline scripts depend on jQuery -->
<script src="{{ '_sm-theme-vendor.min.js' | asset_url }}"></script>
<script>
  // Mark jQuery as ready for the initialization queue
  if (typeof window.ThemeInitQueue !== 'undefined' && typeof jQuery !== 'undefined') {
    window.ThemeInitQueue.markReady('jquery');
  }
</script>

<!-- Cart.js library (MUST load before CartJS.init) -->
<!-- [if gt IE 8]> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/shopify-cartjs/1.1.0/rivets-cart.min.js" defer></script>

<!-- Initialize Cart.js (depends on CartJS library) -->
<script type="text/javascript">
document.addEventListener('DOMContentLoaded', function() {
  // Queue CartJS initialization
  if (typeof window.ThemeInitQueue !== 'undefined') {
    window.ThemeInitQueue.add(function() {
      if (typeof CartJS !== 'undefined' && !window._cartJSInitialized) {
        CartJS.init({{ cart | json }}, {
          "debug": true
        });
        window._cartJSInitialized = true;
        // Mark as ready AFTER this function completes to prevent recursion
        setTimeout(function() {
          window.ThemeInitQueue.markReady('cartjs');
        }, 10);
      }
    }, {
      name: 'CartJS Init',
      priority: 1
    });
  }
});
</script>

<!-- PDP Page Variant Selection -->
{% if request.page_type == 'product' or request.page_type == 'index' %}
  {{ 'option_selection.js' | shopify_asset_url | script_tag }}
{% endif %}

<!-- Custom Styles -->
{{ '_sm-global.css' | asset_url | stylesheet_tag: preload: true }}
{{ '_sm-style.css' | asset_url | stylesheet_tag: preload: true }}

<!-- Picturefill: Load async (not critical for initial render) -->
<script src="https://cdn.jsdelivr.net/picturefill/2.3.1/picturefill.min.js" async></script>

<!-- Custom Scripts: Core theme functions (depends on jQuery) -->
{{ '_sm-theme.js' | asset_url | script_tag }}

<!-- Theme utilities: Can be deferred -->
<script src="{{'theme.js' | asset_url }}" defer="defer"></script>
<!-- Vendor Styles -->                        
{{ '_sm-style-vendor.css' | asset_url | stylesheet_tag: preload: true }}
<!-- Lity CSS -->
{% comment %} {{ 'lity.css' | asset_url | stylesheet_tag }}{% endcomment %}

<!-- For customer templates only -->
{%- if request.page_type contains 'customers/' -%}
  <script src="{{'shopify_common.js' | shopify_asset_url}}" defer="defer"></script>
{%- endif -%}
{% if template contains 'customers' %}
  {{ 'shopify_common.js' | shopify_asset_url | script_tag }}
  {{ 'customer_area.js' | shopify_asset_url | script_tag }}{% endif %}
<!-- Swiper JS and CSS -->

{{ 'iw-search.css' | asset_url | stylesheet_tag: preload: true }}

<script src="{{'iw-search.js' | asset_url}}" defer="defer"></script>
<link rel="stylesheet" href="{{ 'custom.css' | asset_url }}" media="print" onload="this.media='all'">

<link rel="stylesheet" href="{{ 'swiper-bundle.min.css' | asset_url }}" media="print" onload="this.media='all'">
<script src="{{ 'swiper-bundle.min.js' | asset_url }}" defer="defer"></script>

<!-- Fancybox CSS -->
{% comment %}
  {{ 'fancyBox.css' | asset_url | stylesheet_tag }}
  {{ 'fancyBox.js' | asset_url | script_tag }}
{% endcomment %}

{% comment %}
  {{ 'splide.min' | asset_url | stylesheet_tag }}
  <script src="{{ 'splide.min.js' | asset_url }}" defer="defer"></script>
  <script src="{{ 'splide-extension-auto-scroll.min.js' | asset_url }}" defer="defer"></script>
{% endcomment %}
{% comment %} <link rel="preconnect" href="https://fonts.googleapis.com">
<link
  rel="preconnect"
  href="https://fonts.gstatic.com"
  crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Karla:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet"> {% endcomment %}

<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Infiniwell",
    "url": "https://infiniwell.com/",
    "potentialAction": {
      "@type": "SearchAction",
      "target": {
        "@type": "EntryPoint",
        "urlTemplate": "https://infiniwell.com/search?type=product&q={search_term_string}"
      },
      "query-input": {
        "@type": "PropertyValueSpecification",
        "valueRequired": "http://schema.org/True",
        "valueName": "search_term_string"
      }
    }
  }
</script>

<script type="application/ld+json">
  {
    "@type": "Organization",
    "@context": "http://schema.org/",
    "name": "{{ shop.name }}",
    "url": "{{ shop.url }}",
    "logo": "https://infiniwell.com/cdn/shop/files/infiniwell-new.png",
    "contactPoint": {
      "@type": "ContactPoint",
      "telephone": "1-888-819-4640",
      "contactType": "customer service",
      "contactOption": "TollFree",
      "areaServed": "US",
      "availableLanguage": "en"
    }
  }
</script>